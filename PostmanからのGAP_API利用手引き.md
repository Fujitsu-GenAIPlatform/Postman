# Postman からの GAP API 利用手引き

## 概要

このドキュメントは、[Postman](https://www.postman.com/) を使用して GAP (Generative AI Platform) API を利用するための手順を解説します。
主な内容は以下の通りです。

- Postman のコレクションに GAP API を登録する方法
- GAP API の認証 (OAuth 2.0) を設定する方法
- Postman Flows から GAP API を利用する方法

## 1. Postman コレクションの作成と認証設定

はじめに、API リクエストを管理するためのコレクションを作成し、GAP API の認証情報を設定します。

### 1.1. 新規コレクションの作成

1.  Postman の左側パネルで「+」ボタンをクリックし、新しいコレクションを作成します。
2.  コレクションに任意の名前（例: `GAP API`）を付けます。

### 1.2. 認可の設定

作成したコレクションの「認可」タブを開き、以下の通りに設定します。記載のない項目はデフォルト設定のままにしてください。

- **認可タイプ**: `OAuth 2.0`
- **認可データの追加先**: `リクエストヘッダー`

次に、「新しいトークンの設定」セクションで以下の項目を設定します。

- **トークン名**: 任意のトークン名（例: `GAP Token`）
- **Grant タイプ**: `認可コード (PKCE 利用)`
- **コールバック URL**: Postman が自動で設定する URL をそのまま使用します。
- **認可 URL**:
  ```
  https://<テナント名>.b2clogin.com/<テナント名>.onmicrosoft.com/b2c_1_fjcloud_genai_susi/oauth2/v2.0/authorize
  ```
- **アクセストークン URL**:
  ```
  https://<テナント名>.b2clogin.com/<テナント名>.onmicrosoft.com/b2c_1_fjcloud_genai_susi/oauth2/v2.0/token
  ```
- **clientId**: ご自身の `<クライアントID>` を入力します。
- **コードチャレンジメソッド**: `SHA-256`
- **クライアント認証**: `ボディ内のクライアント資格情報を送信`

> **Note** > `<テナント名>` と `<クライアントID>` は、ご自身の環境に合わせて適切な値に置き換えてください。

### 1.3. アクセストークンの取得

1.  画面下部の「新しいアクセストークンを取得」ボタンをクリックします。
2.  認証用のウィンドウが表示されるので、Entra ID でログインします。
3.  認証が成功すると、「Authentication complete」というメッセージが表示されます。

## 2. GAP API リクエストの追加

コレクションの認証設定が完了したら、具体的な API リクエストを追加します。ここでは代表的な `GET` と `POST` の例を示します。他の API についても同様の手順で追加可能です。

### 2.1. GET リクエストの追加

1.  作成したコレクションのメニューから「リクエストを追加」を選択します。
2.  リクエストに任意の名前を付けます。
3.  API 設定画面で以下を設定します。
    - **メソッド**: `GET`
    - **URL**:
      ```
      https://<テナント名>.generative-ai-platform.cloud.global.fujitsu.com/api/v1/...
      ```
      > `/api/v1/` 以降のパスは、GAP の利用者マニュアルを参照してください。
4.  「認可」タブを開き、**認可タイプ** が `上位の認可設定を継承` になっていることを確認します。

### 2.2. POST リクエストの追加

1.  同様に、コレクションに新しいリクエストを追加します。
2.  API 設定画面で以下を設定します。
    - **メソッド**: `POST`
    - **URL**:
      ```
      https://<テナント名>.generative-ai-platform.cloud.global.fujitsu.com/api/v1/...
      ```
3.  「認可」タブの**認可タイプ**が `上位の認可設定を継承` になっていることを確認します。
4.  「ボディ」タブを開き、以下を設定します。
    - `Raw` を選択
    - ドロップダウンメニューから `JSON` を選択
    - テキストエリアにリクエストボディを JSON 形式で入力します。
      > リクエストボディの具体的な内容は、GAP の利用者マニュアルを参照してください。

## 3. Postman Flows からの利用

上記の手順でコレクションの設定が完了すると、Postman Flows の `HTTP Request` ブロックから GAP API を選択できるようになります。これにより、他のブロックと組み合わせて、より高度なワークフローを構築できます。
